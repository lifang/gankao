<%= javascript_include_tag 'jeffrey' %>
<%= javascript_include_tag 'cookie' %>
<script language="javascript" type="text/javascript">
  var papers = new Object();
</script>
<%= javascript_include_tag "#{@paper_url}" %>
<%= javascript_include_tag "#{Constant::SERVER_PATH}/javascripts/answer_paper.js" %>
<%= form_for :paper , :url => "/user/examinations/#{@examination.id}/save_result",
  :html => {:name => "paper_form", :id => "paper_form",
  :onsubmit => "return generate_result_paper('#{@examination.paper_id}')"} do |f| %>
  <div id="show_flash"></div>
  <div class="testPaper_top" id="paper_show_info">
    <div class="tp_top_box" id="float_test">
      <input type="hidden" name="paper_id" id="paper_id" value=""/>
      <input type="hidden" name="all_quesiton_ids" id="all_question_ids" value=""/>
      <input type="hidden" name="problem_ids" id="problem_ids" value=""/>
      <input type="hidden" name="examination_id" id="examination_id" value="<%= @examination.id %>"/>
      <input type="hidden" name="user_id" id="user_id" value="<%= cookies[:user_id] %>"/>
      <div class="paper_name" id="paper_title"></div>
      <div class="timer" id="exam_time"></div>
      <div class="paper_info">
        <strong><span id="leaving_num"></span></strong>题未完成&nbsp;&nbsp;|&nbsp;&nbsp;
        <%= f.submit "结束考试", :class => "Uncertain" %>
      </div>
    </div>
  </div>

  <div class="testPaper_main">
    <div id="blocks">
      <div id="block_ids" style="display:none;"></div>
    </div>
    <!--试卷left-->
    <div class="tp_right" id="paper_navigation">
    </div>
    <div id="remote_div" style="display:none;"></div>
    <input type="hidden" name="types" value="<%= @examination.types %>"/>
    <input type="hidden" name="answer_url" id="answer_url"
           value="<%= Constant::ANSWER_CLIENT_PATH %>/<%= @examination.exam_user_id %>.xml"/>
    <div class="clear"></div>
  </div>
<% end %>
<script type="text/javascript" src="/javascripts/local_save/answer.js" charset="utf-8"></script>
<script type="text/javascript">
  //考试时间定时器所需变量
  var timer = null;
  var normalelapse = 100;
  var nextelapse = normalelapse;
  var start = "";
  //模块定时和考试定时
  var is_fix_time = false;
  var block_start_hash = null;
  var block_end_hash = null;
  var finish = "00:00:00:00";

  //本地存储所需变量finish
  var local_timer = null;
  var local_start_time = "05:00:00";
  var local_finish_time = "00:00:00";

  //用户保存本地存储的答案
  var answer_hash = null;
  //load已有的答案
  load_answer('<%= @exam_user.paper_id %>', '<%= @examination.id %>');

  //定时模块完成定时器
  var load_fix_time = null;

  //页面load成功之后加载试卷
  window.onload(load_paper());
  answer_hash = null;


</script>